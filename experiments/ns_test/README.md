# Noise Suppression (RNNoise)

This folder contains test programs and prototypes for reducing background noise in microphone recordings using RNNoise.

## Structure

```
ns_test/
├── rnnoise.cpp             # Noise suppression prototype
├── recording_8ch_nc.wav    # example output
└── README.md
```

## What this prototype does

- Records ~5 seconds of **8-channel** audio from an input device (PortAudio)
- Runs **RNNoise** on each channel (or whichever channels the code applies it to)
- Writes a multi-channel `.wav` output file

RNNoise is **noise suppression**, not echo cancellation. It can introduce artifacts and can affect timing/phase, which matters if you later do TDOA/DoA on the processed audio.

## Files

### `rnnoise.cpp`
Prototype that integrates RNNoise into the recording pipeline and exports an 8-channel WAV.

### `recording_8ch_nc.wav`
Example output generated by `rnnoise.cpp`.

Use a tool that supports multichannel WAV to inspect it (or split channels first).

## Build notes (Linux)

Tooling:
```bash
sudo apt update
sudo apt install -y build-essential pkg-config
```

Install:
```bash
sudo apt install -y portaudio19-dev librnnoise-dev
```

Build:
```bash
g++ -O3 -std=c++17 rnnoise.cpp -o rnnoise \
  $(pkg-config --cflags --libs portaudio-2.0 rnnoise) \
  -lm -pthread
```
Run:
```bash
./rnnoise
```

### ALSA plughw note
If your device cannot do 48 kHz natively, you must run with ALSA `plughw` conversion:
```bash
PA_ALSA_PLUGHW=1 ./rnnoise
```

## Expected Result
- Background noise should be reduced in the output WAV
- Speech should remain intelligible, but artifacts are possible (robotic tone / gating), especially at low SNR